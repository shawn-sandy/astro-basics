---
import Card from './Card.astro'
import {
  getTopFeatures,
  getAllFeatures,
  getFeaturesByCategory,
  type FeatureCard,
} from '#/data/features'

export type Props = {
  /** Number of feature cards to display (default: 6) */
  count?: number
  /** Filter by category (optional) */
  category?: FeatureCard['category']
  /** Show all features regardless of count */
  showAll?: boolean
  /** Custom CSS class for the container */
  className?: string
}

const {
  count = 6,
  category,
  showAll = false,
  className = '',
} = Astro.props

// Get features based on props
let features: FeatureCard[]
if (category) {
  features = getFeaturesByCategory(category)
} else if (showAll) {
  features = getAllFeatures()
} else {
  features = getTopFeatures(count)
}
---

<div data-flex="cols-3">
  {
    features.map(feature => (
      <Card cardTitle={feature.title} {...(feature.link && { cardLink: feature.link })}>
        <p>{feature.description}</p>
      </Card>
    ))
  }
</div>
<style>
  [data-grid],
  [data-flex] {
    width: 100%;
    max-width: 100%;
    border-radius: 0;
  }
  [data-card] {
    border-radius: 0;
  }
</style>
