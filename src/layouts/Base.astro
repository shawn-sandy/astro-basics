---
// import { ClientOnly } from "astro:transitions";
import Navigation from '#components/astro/Navigation.astro'
import Footer from '#components/astro/Footer.astro'
import Header from '#components/astro/Header.astro'
// import PWAInstallPrompt from '#components/astro/PWAInstallPrompt.astro'
// import OfflineIndicator from '#components/astro/OfflineIndicator.astro'

import { SITE_DESCRIPTION, SITE_TITLE } from '#utils/site-config'
import '@fpkit/acss/styles'
import '../styles/index.css'
import { SignedIn, SignedOut, UserButton, SignInButton } from '@clerk/astro/components'
const isPWAEnabled = import.meta.env.PWA_ENABLED === 'true' || false
// types
type routeItem = {
  name: string
  url: string
  path?: string
}
type Props = {
  pageTitle?: string
  pageDescription?: string
  pageImageUrl?: string
  showBreadcrumb?: boolean
  breadcrumbRoutes?: routeItem[]
  hideHeader?: boolean
}

const showBreadcrumb = Astro.props.showBreadcrumb === undefined ? true : Astro.props.showBreadcrumb

const { pageTitle, pageDescription, pageImageUrl, hideHeader } = Astro.props
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="sitemap" href="/sitemap-index.xml" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- PWA Meta Tags -->
    <meta name="description" content={pageDescription || SITE_DESCRIPTION} />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#1e293b" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="AstroKit" />
    <meta name="application-name" content="AstroKit" />

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png" />

    <!-- Web App Manifest -->
    <link rel="manifest" href="/manifest.webmanifest" />

    <meta name="generator" content={Astro.generator} />
    <title>{pageTitle || SITE_TITLE}</title>
    <!-- <ViewTransitions /> -->
  </head>
  <body>
    <!-- Offline Status Indicator -->
    <!-- <OfflineIndicator /> -->

    <Navigation>
      <ul slot="login">
        <li>
          <SignedIn isStatic={true}>
            <a href="/dashboard">Dashboard</a>
          </SignedIn>
        </li>
        <li class="clerk-user-button">
          <SignedIn isStatic={true}>
            <UserButton />
          </SignedIn>
          <SignedOut isStatic={true}>
            <SignInButton mode="modal" />
          </SignedOut>
        </li>
      </ul>
    </Navigation>

    {
      !hideHeader && (
        <Header
          headerTitle={pageTitle || ''}
          headerDescription={pageDescription || ''}
          headerImageUrl={pageImageUrl || ''}
          headerImageAlt={pageTitle || ''}
        />
      )
    }
    <slot />
    <Footer />

    <!-- PWA Install Prompt -->
    <!-- {isPWAEnabled && <PWAInstallPrompt />} -->
  </body>
</html>
